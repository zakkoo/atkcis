@page
@model Atk.Cis.Web.Pages.Admin.DataModel
@{
    ViewData["Title"] = "Admin - Data";
}

<h1>Admin Data</h1>

<p>Fetch users and session data.</p>

<form method="post" class="space-y-4">
    <div class="space-y-1">
        <label for="password" class="text-xs uppercase tracking-[0.2em] text-terminal-glow/70">Admin password</label>
        <input id="password" name="Password" type="password" class="w-full max-w-md rounded border border-terminal-glow/50 bg-black px-3 py-2 text-terminal-glow focus:border-terminal-glow focus:outline-none focus:ring-2 focus:ring-terminal-glow/40" />
    </div>
    <button type="submit" class="inline-flex items-center justify-center rounded border border-terminal-glow px-4 py-2 text-terminal-glow transition hover:border-terminal-glow/80 hover:bg-terminal-glow/10">Load data</button>
</form>

<p>@Model.StatusMessage</p>

@if (Model.Users.Count > 0)
{
    <h2>Users</h2>
    <div class="w-screen max-w-none -mx-6 md:-mx-12">
        <div class="overflow-x-auto rounded border border-terminal-glow/30 bg-black/40">
            <table class="w-full border-collapse text-left text-sm">
                <thead class="bg-terminal-glow/10 text-terminal-glow">
            <tr>
                <th class="px-3 py-2 text-xs uppercase tracking-[0.2em]">First name</th>
                <th class="px-3 py-2 text-xs uppercase tracking-[0.2em]">Last name</th>
                <th class="px-3 py-2 text-xs uppercase tracking-[0.2em]">Birthday</th>
                <th class="px-3 py-2 text-xs uppercase tracking-[0.2em]">Code</th>
            </tr>
                </thead>
                <tbody class="divide-y divide-terminal-glow/20 text-terminal-glow/80">
        @foreach (var user in Model.Users)
        {
            <tr>
                <td class="px-3 py-2">@user.FirstName</td>
                <td class="px-3 py-2">@user.LastName</td>
                <td class="px-3 py-2">@user.Birthday?.ToString("dd.MM.yyyy")</td>
                <td class="px-3 py-2">@user.Code</td>
            </tr>
        }
                </tbody>
            </table>
        </div>
    </div>
}

@if (Model.UserSessions.Count > 0)
{
    <h2>User Sessions</h2>
    <div class="w-screen max-w-none -mx-6 md:-mx-12">
        <div class="overflow-x-auto rounded border border-terminal-glow/30 bg-black/40">
            <table class="w-full border-collapse text-left text-sm">
                <thead class="bg-terminal-glow/10 text-terminal-glow">
            <tr>
                <th class="px-3 py-2 text-xs uppercase tracking-[0.2em]">Attakkee</th>
                <th class="px-3 py-2 text-xs uppercase tracking-[0.2em]">Opened at</th>
                <th class="px-3 py-2 text-xs uppercase tracking-[0.2em]">Closed at</th>
                <th class="px-3 py-2 text-xs uppercase tracking-[0.2em]">Closed by</th>
                <th class="px-3 py-2 text-xs uppercase tracking-[0.2em]">Duration</th>
            </tr>
                </thead>
                <tbody class="divide-y divide-terminal-glow/20 text-terminal-glow/80">
        @foreach (var session in Model.UserSessions)
        {
            <tr>
                <td class="px-3 py-2">@session.UserDisplayName</td>
                <td class="px-3 py-2">@session.OpenedAt</td>
                <td class="px-3 py-2">@session.ClosedAt</td>
                <td class="px-3 py-2">@session.ClosedBy</td>
                <td class="px-3 py-2">@session.Duration</td>
            </tr>
        }
                </tbody>
            </table>
        </div>
    </div>
}
